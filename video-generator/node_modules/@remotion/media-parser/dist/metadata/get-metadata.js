"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hasMetadata = exports.getMetadata = void 0;
const get_metadata_from_flac_1 = require("../containers/flac/get-metadata-from-flac");
const get_metadata_from_mp3_1 = require("../containers/mp3/get-metadata-from-mp3");
const get_metadata_from_wav_1 = require("../containers/wav/get-metadata-from-wav");
const metadata_from_iso_1 = require("./metadata-from-iso");
const metadata_from_matroska_1 = require("./metadata-from-matroska");
const metadata_from_riff_1 = require("./metadata-from-riff");
const getMetadata = (state) => {
    var _a, _b;
    const structure = state.getStructure();
    if (structure.type === 'matroska') {
        return (0, metadata_from_matroska_1.getMetadataFromMatroska)(structure);
    }
    if (structure.type === 'riff') {
        return (0, metadata_from_riff_1.getMetadataFromRiff)(structure);
    }
    if (structure.type === 'transport-stream') {
        return [];
    }
    if (structure.type === 'mp3') {
        const tags = (0, get_metadata_from_mp3_1.getMetadataFromMp3)(structure);
        if (tags === null) {
            throw new Error('Failed to get metadata from mp3');
        }
        return tags;
    }
    if (structure.type === 'wav') {
        return (_a = (0, get_metadata_from_wav_1.getMetadataFromWav)(structure)) !== null && _a !== void 0 ? _a : [];
    }
    if (structure.type === 'aac') {
        return [];
    }
    if (structure.type === 'flac') {
        return (_b = (0, get_metadata_from_flac_1.getMetadataFromFlac)(structure)) !== null && _b !== void 0 ? _b : [];
    }
    return (0, metadata_from_iso_1.getMetadataFromIsoBase)(state);
};
exports.getMetadata = getMetadata;
const hasMetadata = (structure) => {
    if (structure.type === 'mp3') {
        return (0, get_metadata_from_mp3_1.getMetadataFromMp3)(structure) !== null;
    }
    if (structure.type === 'wav') {
        return (0, get_metadata_from_wav_1.getMetadataFromWav)(structure) !== null;
    }
    return false;
};
exports.hasMetadata = hasMetadata;
