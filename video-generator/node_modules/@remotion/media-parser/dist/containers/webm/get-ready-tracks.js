"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTracksFromMatroska = void 0;
const make_track_1 = require("./make-track");
const traversal_1 = require("./traversal");
const getTracksFromMatroska = (segment, timescale) => {
    const tracksSegment = (0, traversal_1.getTracksSegment)(segment);
    if (!tracksSegment) {
        throw new Error('No tracks segment');
    }
    const tracks = [];
    for (const trackEntrySegment of tracksSegment.value) {
        if (trackEntrySegment.type === 'Crc32') {
            continue;
        }
        if (trackEntrySegment.type !== 'TrackEntry') {
            throw new Error('Expected track entry segment');
        }
        const track = (0, make_track_1.getTrack)({
            track: trackEntrySegment,
            timescale,
        });
        if (track) {
            tracks.push(track);
        }
    }
    return tracks;
};
exports.getTracksFromMatroska = getTracksFromMatroska;
