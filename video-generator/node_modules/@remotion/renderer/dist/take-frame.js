"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.takeFrame = void 0;
const collect_assets_1 = require("./collect-assets");
const provide_screenshot_1 = require("./provide-screenshot");
const takeFrame = async ({ freePage, imageFormat, jpegQuality, frame, width, height, output, scale, wantsBuffer, timeoutInMilliseconds, }) => {
    const collectedAssets = await (0, collect_assets_1.collectAssets)({
        frame,
        freePage,
        timeoutInMilliseconds,
    });
    if (imageFormat === 'none') {
        return { buffer: null, collectedAssets };
    }
    const shouldMakeBuffer = wantsBuffer;
    const buf = await (0, provide_screenshot_1.provideScreenshot)({
        page: freePage,
        imageFormat,
        jpegQuality,
        options: {
            frame,
            output: wantsBuffer ? null : output,
        },
        height,
        width,
        timeoutInMilliseconds,
        scale,
    });
    if (shouldMakeBuffer) {
        return { buffer: buf, collectedAssets };
    }
    return { buffer: null, collectedAssets };
};
exports.takeFrame = takeFrame;
